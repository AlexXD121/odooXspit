module.exports=[37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},99835,a=>{"use strict";var b=a.i(37936),c=a.i(83479);a.i(40522);var d=a.i(9349),e=a.i(29173),f=a.i(72849),g=a.i(53112),h=a.i(13095);let i=new e.PrismaClient,j=g.z.object({email:g.z.string().email(),password:g.z.string().min(6)});async function k(a){let b=a.get("email"),c=a.get("password");if(console.log("Pre-auth input:",{email:b,password:c}),!j.safeParse({email:b,password:c}).success)return{error:"Invalid email or password format."};try{let a=await i.user.findUnique({where:{email:b}});if(!a||!await f.default.compare(c,a.password))return{error:"Invalid credentials."};let d=Math.floor(1e5+9e5*Math.random()).toString(),e=new Date(Date.now()+3e5);return await i.user.update({where:{email:b},data:{otp:d,otpExpires:e}}),console.log(`ðŸ” OTP for ${b}: ${d}`),{success:!0,message:"OTP sent to your email."}}catch(a){return console.error("Pre-auth error:",a),{error:"Something went wrong."}}}async function l(a,b){try{await (0,c.signIn)("credentials",b)}catch(a){if(a instanceof d.AuthError)if("CredentialsSignin"===a.type)return"Invalid OTP or credentials.";else return"Something went wrong.";throw a}}let m=g.z.object({name:g.z.string().min(2,{message:"Name must be at least 2 characters long."}),email:g.z.string().email({message:"Please enter a valid email address."}),password:g.z.string().min(6,{message:"Password must be at least 6 characters long."}),confirmPassword:g.z.string()}).refine(a=>a.password===a.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});async function n(a,b){let c=b.get("name"),d=b.get("email"),e=b.get("password"),g=b.get("confirmPassword"),h=m.safeParse({name:c,email:d,password:e,confirmPassword:g});if(!h.success)return{error:h.error.flatten().fieldErrors};try{if(await i.user.findUnique({where:{email:d}}))return{error:{email:["Email already in use."]}};let a=await f.default.hash(e,10);return await i.user.create({data:{name:c,email:d,password:a,role:"USER"}}),{success:!0,message:"Account created successfully. Please log in."}}catch(a){return console.error("Registration error:",a),{error:{form:["Something went wrong. Please try again."]}}}}async function o(){await (0,c.signOut)()}(0,h.ensureServerEntryExports)([k,l,n,o]),(0,b.registerServerReference)(k,"40d12781802ab3aab57f0ca9725d2f90dea69b1725",null),(0,b.registerServerReference)(l,"6089715bce84d2d6ec2b584d091fb47ceb9a4a00c4",null),(0,b.registerServerReference)(n,"60b78c7cae6fecc38121e5674933901f3d21b0f3dc",null),(0,b.registerServerReference)(o,"00113b3ea0d5bdec66bf3a02a9e7d2d58ec09f7cf9",null),a.s(["authenticate",()=>l,"preAuthenticate",()=>k,"registerUser",()=>n,"signOutAction",()=>o])},43869,a=>{"use strict";var b=a.i(99835);a.s([],15068),a.i(15068),a.s(["00113b3ea0d5bdec66bf3a02a9e7d2d58ec09f7cf9",()=>b.signOutAction,"40d12781802ab3aab57f0ca9725d2f90dea69b1725",()=>b.preAuthenticate,"6089715bce84d2d6ec2b584d091fb47ceb9a4a00c4",()=>b.authenticate,"60b78c7cae6fecc38121e5674933901f3d21b0f3dc",()=>b.registerUser],43869)}];

//# sourceMappingURL=_f8612632._.js.map